<template>
<header-componant />
<nav-componant />
<!-- Page Area Start Here -->
        <div class="dashboard-page-one">
            <!-- Sidebar Area Start Here -->
            <div class="sidebar-main sidebar-menu-one sidebar-expand-md sidebar-color">
               <div class="mobile-sidebar-header d-md-none">
                    <div class="header-logo">
                        <a href="index.html"><img src="/custom_folder/img/logo1.png" alt="logo"></a>
                    </div>
               </div>
                <div class="sidebar-menu-content">
                    <ul class="nav nav-sidebar-menu sidebar-toggle-view">
                        <li class="nav-item sidebar-nav-item">
                            <a href="#" class="nav-link"><i class="flaticon-dashboard"></i><span>Dashboard</span></a>
                            <ul class="nav sub-group-menu">
                                <li class="nav-item">
                                    <a href="index.html" class="nav-link"><i class="fas fa-angle-right"></i>Admin</a>
                                </li>
                                <li class="nav-item">
                                    <a href="index3.html" class="nav-link"><i
                                            class="fas fa-angle-right"></i>Students</a>
                                </li>
                                <li class="nav-item">
                                    <a href="index4.html" class="nav-link"><i class="fas fa-angle-right"></i>Parents</a>
                                </li>
                                <li class="nav-item">
                                    <a href="index5.html" class="nav-link"><i
                                            class="fas fa-angle-right"></i>Teachers</a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item sidebar-nav-item">
                            <a href="#" class="nav-link"><i class="flaticon-classmates"></i><span>Students</span></a>
                            <ul class="nav sub-group-menu">
                                <li class="nav-item">
                                    <a href="all-student.html" class="nav-link"><i class="fas fa-angle-right"></i>All
                                        Students</a>
                                </li>
                                <li class="nav-item">
                                    <a href="student-details.html" class="nav-link"><i
                                            class="fas fa-angle-right"></i>Student Details</a>
                                </li>
                                <li class="nav-item">
                                    <a href="admit-form.html" class="nav-link"><i
                                            class="fas fa-angle-right"></i>Admission Form</a>
                                </li>
                                <li class="nav-item">
                                    <a href="student-promotion.html" class="nav-link"><i
                                            class="fas fa-angle-right"></i>Student Promotion</a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item sidebar-nav-item">
                            <a href="#" class="nav-link"><i
                                    class="flaticon-multiple-users-silhouette"></i><span>Teachers</span></a>
                            <ul class="nav sub-group-menu">
                                <li class="nav-item">
                                    <a href="all-teacher.html" class="nav-link"><i class="fas fa-angle-right"></i>All
                                        Teachers</a>
                                </li>
                                <li class="nav-item">
                                    <a href="teacher-details.html" class="nav-link"><i
                                            class="fas fa-angle-right"></i>Teacher Details</a>
                                </li>
                                <li class="nav-item">
                                    <a href="add-teacher.html" class="nav-link"><i class="fas fa-angle-right"></i>Add
                                        Teacher</a>
                                </li>
                                <li class="nav-item">
                                    <a href="teacher-payment.html" class="nav-link"><i
                                            class="fas fa-angle-right"></i>Payment</a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item sidebar-nav-item">
                            <a href="#" class="nav-link"><i class="flaticon-couple"></i><span>Parents</span></a>
                            <ul class="nav sub-group-menu">
                                <li class="nav-item">
                                    <a href="all-parents.html" class="nav-link"><i class="fas fa-angle-right"></i>All
                                        Parents</a>
                                </li>
                                <li class="nav-item">
                                    <a href="parents-details.html" class="nav-link"><i
                                            class="fas fa-angle-right"></i>Parents Details</a>
                                </li>
                                <li class="nav-item">
                                    <a href="add-parents.html" class="nav-link"><i class="fas fa-angle-right"></i>Add
                                        Parent</a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item sidebar-nav-item">
                            <a href="#" class="nav-link"><i class="flaticon-books"></i><span>Library</span></a>
                            <ul class="nav sub-group-menu">
                                <li class="nav-item">
                                    <a href="all-book.html" class="nav-link"><i class="fas fa-angle-right"></i>All
                                        Book</a>
                                </li>
                                <li class="nav-item">
                                    <a href="add-book.html" class="nav-link"><i class="fas fa-angle-right"></i>Add New
                                        Book</a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item sidebar-nav-item">
                            <a href="#" class="nav-link"><i class="flaticon-technological"></i><span>Acconunt</span></a>
                            <ul class="nav sub-group-menu">
                                <li class="nav-item">
                                    <a href="all-fees.html" class="nav-link"><i class="fas fa-angle-right"></i>All Fees
                                        Collection</a>
                                </li>
                                <li class="nav-item">
                                    <a href="all-expense.html" class="nav-link"><i
                                            class="fas fa-angle-right"></i>Expenses</a>
                                </li>
                                <li class="nav-item">
                                    <a href="add-expense.html" class="nav-link"><i class="fas fa-angle-right"></i>Add
                                        Expenses</a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item sidebar-nav-item">
                            <a href="#" class="nav-link"><i
                                    class="flaticon-maths-class-materials-cross-of-a-pencil-and-a-ruler"></i><span>Class</span></a>
                            <ul class="nav sub-group-menu">
                                <li class="nav-item">
                                    <a href="all-class.html" class="nav-link"><i class="fas fa-angle-right"></i>All
                                        Classes</a>
                                </li>
                                <li class="nav-item">
                                    <a href="add-class.html" class="nav-link"><i class="fas fa-angle-right"></i>Add New
                                        Class</a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a href="all-subject.html" class="nav-link"><i
                                    class="flaticon-open-book"></i><span>Subject</span></a>
                        </li>
                        <li class="nav-item">
                            <a href="class-routine.html" class="nav-link"><i class="flaticon-calendar"></i><span>Class
                                    Routine</span></a>
                        </li>
                        <li class="nav-item">
                            <a href="student-attendence.html" class="nav-link"><i
                                    class="flaticon-checklist"></i><span>Attendence</span></a>
                        </li>
                        <li class="nav-item sidebar-nav-item">
                            <a href="#" class="nav-link"><i class="flaticon-shopping-list"></i><span>Exam</span></a>
                            <ul class="nav sub-group-menu">
                                <li class="nav-item">
                                    <a href="exam-schedule.html" class="nav-link"><i class="fas fa-angle-right"></i>Exam
                                        Schedule</a>
                                </li>
                                <li class="nav-item">
                                    <a href="exam-grade.html" class="nav-link"><i class="fas fa-angle-right"></i>Exam
                                        Grades</a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a href="transport.html" class="nav-link"><i
                                    class="flaticon-bus-side-view"></i><span>Transport</span></a>
                        </li>
                        <li class="nav-item">
                            <a href="hostel.html" class="nav-link"><i class="flaticon-bed"></i><span>Hostel</span></a>
                        </li>
                        <li class="nav-item">
                            <a href="notice-board.html" class="nav-link"><i
                                    class="flaticon-script"></i><span>Notice</span></a>
                        </li>
                        <li class="nav-item">
                            <a href="messaging.html" class="nav-link"><i
                                    class="flaticon-chat"></i><span>Messeage</span></a>
                        </li>
                        <li class="nav-item sidebar-nav-item">
                            <a href="#" class="nav-link"><i class="flaticon-menu-1"></i><span>UI Elements</span></a>
                            <ul class="nav sub-group-menu">
                                <li class="nav-item">
                                    <a href="notification-alart.html" class="nav-link"><i class="fas fa-angle-right"></i>Alart</a>
                                </li>
                                <li class="nav-item">
                                    <a href="button.html" class="nav-link"><i class="fas fa-angle-right"></i>Button</a>
                                </li>
                                <li class="nav-item">
                                    <a href="grid.html" class="nav-link"><i class="fas fa-angle-right"></i>Grid</a>
                                </li>
                                <li class="nav-item">
                                    <a href="modal.html" class="nav-link"><i class="fas fa-angle-right"></i>Modal</a>
                                </li>
                                <li class="nav-item">
                                    <a href="progress-bar.html" class="nav-link"><i class="fas fa-angle-right"></i>Progress Bar</a>
                                </li>
                                <li class="nav-item">
                                    <a href="ui-tab.html" class="nav-link"><i class="fas fa-angle-right"></i>Tab</a>
                                </li>
                                <li class="nav-item">
                                    <a href="ui-widget.html" class="nav-link"><i
                                            class="fas fa-angle-right"></i>Widget</a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a href="map.html" class="nav-link"><i
                                    class="flaticon-planet-earth"></i><span>Map</span></a>
                        </li>
                        <li class="nav-item">
                            <a href="account-settings.html" class="nav-link"><i
                                    class="flaticon-settings"></i><span>Account</span></a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Sidebar Area End Here -->






           <div class="dashboard-content-one">
                <!-- Breadcubs Area Start Here -->
                <div class="breadcrumbs-area">

                    <ul>
                        <li>
                            <a href="dashboard">Dashboard</a>
                        </li>
                        <li>Add Fees</li>
                    </ul>

                </div>

                <!-- Breadcubs Area End Here -->
                  <!-- Admit Form Area Start Here -->
                <div class="card height-auto">
                    <div class="card-body">
                        <div class="heading-layout1">
                            <div class="item-title">
                                <h3>Add Student Fees</h3>
                            </div>

                        </div>
                        <form @submit.prevent="submit">
                            <div class="row">
                                <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Select Class Name *</label>
                                    <select name="class_name" id="class_name" v-model="form.className">
                                    <optgroup label="Select Class Name" >
                                           <option v-for="(classObj,index) in allClasses" :key="index" :value="classObj.id">{{classObj.class_name}}</option>
                                        </optgroup>
                                    </select>
                                </div>

                                <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Select Section Name *</label>
                                     <select name="section_name" id="section_name" v-model="form.sectionName">
                                     <optgroup label="Select Section Name">
                                        <option v-for="(section,index) in allSections" :key="index" :value="section.id">{{section.section_name}}</option>
                                        </optgroup>
                                    </select>
                                </div>

                                <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Student Name *</label>
                                    <select name="student_name" id="student_name" v-model="form.studentName">
                                      <optgroup label="Select Student Name">
                                       <option v-for="(student,index) in students" :key="index" :value="student.id">{{student.user.first_name}} {{student.user.last_name}}</option>

                                       </optgroup>
                                    </select>
                                </div>

                                <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Father Name *</label>
                                    <select name="father_name" id="father_name" v-model="form.fatherName">
                                      <optgroup label="Select Father Name">
                                       <option value=""></option>

                                       </optgroup>
                                    </select>
                                </div>

                                 <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Payment Mode *</label>
                                    <select name="payment_mode" v-model="form.paymentMethod">
                                      <optgroup label="Select Payment Mode">
                                       <option value="cash">Cash</option>
                                       <option value="bank_deposit">Bank Deposit</option>
                                       <option value="cheque">Cheque</option>
                                       <option value="credit_card">Credit card</option>
                                       <option value="debit_card">Debit card</option>
                                       <option value="other">Other</option>
                                       </optgroup>
                                    </select>
                                </div>

                                 <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Receipt Number</label>
                                <input type="text" name="receipt_number" v-model="form.receiptNumber">
                                </div>



                                  <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Fees Submission Date *</label>
                                <input type="date" name="receipt_number" v-model="form.feesSubmitionDate">
                                </div>

                                 <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Admission Fees</label>
                                <input type="text" name="admission_fees"  v-model="form.addmissionFee">
                                </div>
                                 <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Tuition Fees</label>
                                <input type="text" name="tuition_fees" v-model="form.tutuionFee">
                                </div>

                                 <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Sports Fees</label>
                                <input type="text" name="sports_fees"  v-model="form.sportsFee">
                                </div>

                                 <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Hostel Fees</label>
                                <input type="text" name="hostel_fees" v-model="form.hostelFee">
                                </div>

                                 <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Food Fees</label>
                                <input type="text" name="food_fees"  v-model="form.foodFee">
                                </div>

                                 <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Transportation Fees</label>
                                <input type="text" name="transportation_fees" v-model="form.transpotationFee">
                                </div>

                                 <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Activity Fees</label>
                                <input type="text" name="activity_fees" v-model="form.activityFees">
                                </div>

                                 <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Extra Class Fees</label>
                                <input type="text" name="extra_class_fees" v-model="form.extraClassFees">
                                </div>

                                <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Other</label>
                                <input type="text" name="other" v-model="form.others">
                                </div>

                                <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Penality</label>
                                <input type="text" name="penality" v-model="form.penality">
                                </div>

                                <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Pending Dues</label>
                                <input type="text" name="pending_dues" v-model="form.pendingDue">
                                </div>
                                <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Total Fees*</label>
                                <input type="text" name="total_fees" v-model="form.totalFee">
                                </div>
                                <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Fee Date</label>

                                </div>
                                <div class="col-xl-3 col-lg-6 col-12 form-group">
                                    <label>Notes*</label>
                                        <textarea type="text" name="note" class="form-group" v-model="form.note">    </textarea>
                                </div>
                                <div class="col-12 form-group mg-t-8">
                                    <button type="submit" class="btn-fill-lg btn-gradient-yellow btn-hover-bluedark">Save</button>
                                        </div>
                            </div>
                        </form>
                    </div>
                </div>
                </div>

                </div>
                <!-- Admit Form Area End Here -->
<footer-componant />

</template>

<script>

import Footer from '@/Pages/Admin/Footer.vue'
import Header from '@/Pages/Admin/Header.vue'
import Nav from '@/Pages/Admin/Nav.vue'

import { ref } from 'vue';

export default {

    setup() {
        const date = ref(new Date());
        // In case of a range picker, you'll receive [Date, Date]
        const format = (date) => {
            // const day = date.getDate();
            const month = date.getMonth() + 1;
            const year = date.getFullYear();

            return `Selected date is ${day}/${month}/${year}`;
        }

        return {
            date,
            format,
        }
    },
     props:{
         errors: Object,
     },
    components: {
        FooterComponant: Footer,
        HeaderComponant: Header,
        NavComponant: Nav,
        Datepicker
    },

    mounted(){
        this.fetchClass();
        this.fetchSections();
    },
    data() {
        return {
            form:{
                className:'',
                sectionName:'',
                studentName:'',
                fatherName:'',
                paymentMethod:'',
                receiptNumber:'',
                feesSubmitionDate:'',
                addmissionFee:'',
                tutuionFee:'',
                tutuionFee:'',
                sportsFee:'',
                hostelFee:'',
                foodFee:'',
                transpotationFee:'',
                activityFees:'',
                extraClassFees:'',
                others:'',
                penality:'',
                pendingDue:'',
                totalFee:'',
                feeDate:ref(new Date()),
                note:''
            },
            allClasses:[],
            allSections:[],
            students:[],
            errors:{},

        }
    },
        methods: {
            fetchClass(){
                axios.get('get-all-classes')
                .then(res =>{
                    this.allClasses = res.data
                })
            },
            fetchSections(){
                  axios.get('get-all-sections')
                .then(res =>{
                    this.allSections = res.data
                })
            },
            submit() {
              this.errors = {};
              axios.post('feespost',this.form)
              .then(res=>{
                    this.form={};
                    Toast.fire({
                        icon:'success',
                        title:'Fees is deposited !!!'
                    })
            }).catch((error) => {
                this.errors = error.response.data.errors
            });

           },
           fetchStudent(){
            if(this.form.className && this.form.sectionName){
                     axios.get('fetch-students',{
                        params:{
                            classId: this.form.className,
                            sectionId: this.form.sectionName,
                        }
                     })
                .then(res=>{
                    this.students = res.data;
                }).catch((error) => {
                    this.errors = error.response.data.errors
                });
            }
           }
        },
        watch:{
            'form.className'(newVal){
                this.fetchStudent();
            },
            'form.sectionName'(newVal){
                this.fetchStudent();
            },
            'form.studentName'(newVal){
                console.log(this.students , "student")
            }


        }
}

</script>


